package main

import (
	"github.com/stretchr/testify/assert"
	"testing"
)

func TestCookieParser(t *testing.T) {
	rawCookies := `connect.sid=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfdG9rZW5FeHBpcmVUaW1lIjo1NDAwLCJjb25uZWN0ZWRBdCI6IjIwMjEtMDktMDFUMDU6NTY6NTMuNTIzWiIsInVzZXJJRCI6NDQ3NDU1LCJ1c2VyTmFtZSI6IiIsImV4dGVybmFsQWNjb3VudCI6bnVsbCwiY3VycmljdWx1bV9pZCI6OCwiY3VycmljdWx1bV90eXBlIjoiVkFDQVRJT04iLCJkaWZmaWN1bHR5IjoyNSwicGF5bWVudENoZWNrIjpmYWxzZSwidG9rZW5fYWNjb3VudCI6ImVsZTQydjkwIiwicHJvZHVjdFR5cGUiOiJFTEVNIiwic3RhbXAiOiJzaGExJGI5ZGIzMWFjJDEkZGYwY2I5NzM4M2EwZDk5MTEzYjc4MjRkNmRmMTkyNWE0YTQ1NTI1MSIsImNsaWVudFZlcnNpb24iOjEwMjAwMDMsImFwaV92ZXJzaW9uIjoidjIiLCJ1c2VyVHlwZSI6IktOT1dSRV9URVNUIiwidGljayI6MSwiaWF0IjoxNjMwNDc1ODEzLCJleHAiOjE2MzA0ODEyMTN9.NN-16Ru7nz0BAmaZeKfwWekfCngN-sZH63rOzUywGr0; Domain=local.knowreapp.com; Path=/`

	m := make(CookieMap)
	m.Parse(rawCookies)
	sid := m["connect.sid"]

	assert.Equal(t, sid, "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfdG9rZW5FeHBpcmVUaW1lIjo1NDAwLCJjb25uZWN0ZWRBdCI6IjIwMjEtMDktMDFUMDU6NTY6NTMuNTIzWiIsInVzZXJJRCI6NDQ3NDU1LCJ1c2VyTmFtZSI6IiIsImV4dGVybmFsQWNjb3VudCI6bnVsbCwiY3VycmljdWx1bV9pZCI6OCwiY3VycmljdWx1bV90eXBlIjoiVkFDQVRJT04iLCJkaWZmaWN1bHR5IjoyNSwicGF5bWVudENoZWNrIjpmYWxzZSwidG9rZW5fYWNjb3VudCI6ImVsZTQydjkwIiwicHJvZHVjdFR5cGUiOiJFTEVNIiwic3RhbXAiOiJzaGExJGI5ZGIzMWFjJDEkZGYwY2I5NzM4M2EwZDk5MTEzYjc4MjRkNmRmMTkyNWE0YTQ1NTI1MSIsImNsaWVudFZlcnNpb24iOjEwMjAwMDMsImFwaV92ZXJzaW9uIjoidjIiLCJ1c2VyVHlwZSI6IktOT1dSRV9URVNUIiwidGljayI6MSwiaWF0IjoxNjMwNDc1ODEzLCJleHAiOjE2MzA0ODEyMTN9.NN-16Ru7nz0BAmaZeKfwWekfCngN-sZH63rOzUywGr0")
}
